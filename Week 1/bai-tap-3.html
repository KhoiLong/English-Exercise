<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Writing Coach: Remedial Practice (15 Mins)</title>
<style>
    :root {
        --primary: #457b9d; /* Xanh d∆∞∆°ng ƒë·∫≠m ƒë√† */
        --secondary: #1d3557;
        --accent: #e63946; /* ƒê·ªè t·∫°o ƒëi·ªÉm nh·∫•n */
        --bg: #f1faee;
        --text: #333;
    }
    body {
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        background-color: var(--bg);
        color: var(--text);
        line-height: 1.6;
        margin: 0;
        padding: 20px;
        padding-top: 70px;
    }
    .container {
        max-width: 800px;
        margin: 0 auto;
        background: white;
        padding: 30px;
        border-radius: 15px;
        box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        display: none; /* ·∫®n l√∫c ƒë·∫ßu */
    }
    
    /* START SCREEN */
    #start-screen {
        max-width: 600px;
        margin: 50px auto;
        background: white;
        padding: 40px;
        border-radius: 15px;
        text-align: center;
        box-shadow: 0 10px 25px rgba(0,0,0,0.15);
    }
    .btn-start {
        background: var(--accent);
        color: white;
        border: none;
        padding: 20px 40px;
        font-size: 1.5em;
        font-weight: bold;
        border-radius: 50px;
        cursor: pointer;
        transition: transform 0.2s;
        box-shadow: 0 4px 10px rgba(230, 57, 70, 0.4);
    }
    .btn-start:hover { transform: scale(1.05); background: #d62828; }

    /* Sticky Timer */
    #timer-bar {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        background: var(--secondary);
        color: white;
        text-align: center;
        padding: 15px 0;
        font-size: 1.5em;
        font-weight: bold;
        z-index: 1000;
        box-shadow: 0 2px 10px rgba(0,0,0,0.2);
        display: none; /* ·∫®n l√∫c ƒë·∫ßu */
    }
    .warning { background-color: #d62828 !important; animation: pulse 1s infinite; }
    
    @keyframes pulse {
        0% { transform: scale(1); }
        50% { transform: scale(1.02); }
        100% { transform: scale(1); }
    }

    h1 { color: var(--secondary); text-align: center; border-bottom: 2px solid var(--primary); padding-bottom: 10px; }
    
    .question-card {
        background: #fff;
        border: 1px solid #ddd;
        border-left: 5px solid var(--primary);
        padding: 20px;
        margin-bottom: 20px;
        border-radius: 8px;
        transition: 0.3s;
    }
    .question-text { font-weight: bold; font-size: 1.1em; margin-bottom: 15px; display: block; }
    
    .options label {
        display: block;
        margin-bottom: 10px;
        cursor: pointer;
        padding: 10px;
        background: #f9f9f9;
        border-radius: 5px;
        border: 1px solid #eee;
        transition: 0.2s;
    }
    .options label:hover { background: #eef; border-color: var(--primary); }
    .options input[type="radio"] { margin-right: 10px; transform: scale(1.2); }

    /* Explanation Styles */
    .explanation-box {
        margin-top: 15px;
        padding: 15px;
        background-color: #e9f5f5;
        border-radius: 5px;
        border-left: 4px solid var(--secondary);
        display: none;
        font-size: 0.95em;
    }
    .exp-title { font-weight: bold; color: var(--secondary); display: block; margin-bottom: 5px; }
    .correct-text { color: #2a9d8f; font-weight: bold; }
    .wrong-text { color: #e63946; font-weight: bold; }

    .btn-submit {
        display: block;
        width: 100%;
        padding: 15px;
        background: var(--primary);
        color: white;
        border: none;
        border-radius: 8px;
        font-size: 1.2em;
        cursor: pointer;
        margin-top: 30px;
        font-weight: bold;
    }
    .btn-submit:hover { background: #1d3557; }
    .btn-submit:disabled { background: #ccc; cursor: not-allowed; }

    /* REPORT AREA */
    #report-section {
        display: none;
        margin-top: 30px;
        padding: 20px;
        background: #f0f4f8;
        border: 2px dashed #264653;
        border-radius: 10px;
    }
    textarea#final-report {
        width: 100%;
        height: 200px;
        font-family: monospace;
        padding: 10px;
        border: 1px solid #ccc;
        border-radius: 5px;
        margin-bottom: 10px;
        white-space: pre; 
    }
    .btn-copy {
        background: #2a9d8f;
        color: white;
        padding: 12px 20px;
        border: none;
        border-radius: 5px;
        cursor: pointer;
        font-size: 1em;
        font-weight: bold;
        display: inline-block;
    }
    .btn-copy:hover { background: #1f7a6f; }

</style>
</head>
<body>

<div id="start-screen">
    <h1 style="border:none;">üéØ Chi·∫øn d·ªãch "Tr√°m L·ªó H·ªïng"</h1>
    <p>B√†i t·∫≠p n√†y g·ªìm <b>20 c√¢u</b> t·∫≠p trung v√†o nh·ªØng l·ªói v·ª£ v·ª´a sai:</p>
    <ul style="text-align: left; display: inline-block;">
        <li>‚ö†Ô∏è L·ªói sau Do/Does</li>
        <li>‚ö†Ô∏è L·ªói nh√¨n nh·∫ßm ch·ªß ng·ªØ (Looking at neighbor)</li>
        <li>‚ö†Ô∏è L·ªói V-ing v√† Danh t·ª´ ƒë·∫∑c bi·ªát</li>
    </ul>
    <p>Th·ªùi gian: <b>15 ph√∫t</b></p>
    <button class="btn-start" onclick="startQuiz()">B·∫ÆT ƒê·∫¶U L√ÄM B√ÄI</button>
</div>

<div id="timer-bar">Th·ªùi gian c√≤n l·∫°i: <span id="time">15:00</span></div>

<div class="container" id="quiz-content">
    <h1>üî• Review: 20 C√¢u "Ph·ª•c Th√π"</h1>
    <div id="quiz-container"></div>

    <button class="btn-submit" onclick="submitQuiz()">N·ªôp B√†i & Xem B√°o C√°o</button>
    
    <div id="report-section">
        <h3 style="color: var(--secondary); margin-top: 0;">üìä B√°o C√°o K·∫øt Qu·∫£ (Review)</h3>
        <textarea id="final-report" readonly></textarea>
        <button class="btn-copy" onclick="copyReport()">üìã Sao ch√©p b√°o c√°o</button>
        <span id="copy-status" style="margin-left: 10px; color: green; font-weight: bold; display: none;">ƒê√£ copy!</span>
    </div>
</div>

<script>
    // D·ªÆ LI·ªÜU C√ÇU H·ªéI (20 C√ÇU T·∫¨P TRUNG V√ÄO L·ªñI SAI)
    const questions = [
        // GROUP 1: DO/DOES + V_INF (Kh·∫Øc ph·ª•c l·ªói tr·ª£ l√Ω)
        { q: "1. Does she _____ yoga every morning?", opts: ["do", "does", "doing"], a: "do", exp: "üí° C√≥ 'Does' ƒë·ª©ng ƒë·∫ßu -> ƒê·ªông t·ª´ ch√≠nh v·ªÅ nguy√™n th·ªÉ (do)." },
        { q: "2. He doesn't _____ spicy food.", opts: ["likes", "like", "liking"], a: "like", exp: "üí° C√≥ 'doesn't' (Tr·ª£ l√Ω) -> ƒê·ªông t·ª´ ch√≠nh ngh·ªâ ng∆°i (like)." },
        { q: "3. Does your father _____ to work by car?", opts: ["drive", "drives", "driving"], a: "drive", exp: "üí° C√¢u h·ªèi c√≥ 'Does' -> ƒê·ªông t·ª´ v·ªÅ nguy√™n th·ªÉ." },
        { q: "4. My cat doesn't _____ milk.", opts: ["drink", "drinks", "drinking"], a: "drink", exp: "üí° Sau 'doesn't' lu√¥n l√† V nguy√™n th·ªÉ." },
        { q: "5. Why does he _____ so angry?", opts: ["look", "looks", "looking"], a: "look", exp: "üí° C√≥ 'does' trong c√¢u h·ªèi -> 'Look' gi·ªØ nguy√™n." },

        // GROUP 2: V-ING & TIME/MONEY (Kh·∫Øc ph·ª•c l·ªói ch·ªß ng·ªØ gi·∫£)
        { q: "6. Learning new languages _____ difficult.", opts: ["is", "are", "be"], a: "is", exp: "‚ö†Ô∏è Ch·ªß ng·ªØ l√† V-ing (Learning) -> Lu√¥n s·ªë √≠t." },
        { q: "7. Eating vegetables _____ good for health.", opts: ["is", "are", "be"], a: "is", exp: "‚ö†Ô∏è Ch·ªß ng·ªØ l√† h√†nh ƒë·ªông 'Eating' -> S·ªë √≠t (d√π vegetables s·ªë nhi·ªÅu)." },
        { q: "8. Ten minutes _____ not enough time.", opts: ["is", "are", "be"], a: "is", exp: "‚åö 10 ph√∫t l√† 'm·ªôt kho·∫£ng th·ªùi gian' -> S·ªë √≠t." },
        { q: "9. Fifty dollars _____ too expensive for this shirt.", opts: ["is", "are", "be"], a: "is", exp: "üíµ S·ªë ti·ªÅn lu√¥n ƒë∆∞·ª£c t√≠nh l√† ƒë∆°n v·ªã s·ªë √≠t." },
        { q: "10. Reading two books a week _____ my goal.", opts: ["is", "are", "be"], a: "is", exp: "‚ö†Ô∏è 'Reading' l√† ch·ªß ng·ªØ ch√≠nh -> S·ªë √≠t." },

        // GROUP 3: "DON'T LOOK AT THE NEIGHBOR" (Kh·∫Øc ph·ª•c l·ªói nh√¨n nh·∫ßm)
        { q: "11. The box of chocolates _____ on the table.", opts: ["is", "are", "be"], a: "is", exp: "üì¶ Ch·ªß ng·ªØ ch√≠nh l√† 'The box' (1 c√°i h·ªôp) -> S·ªë √≠t." },
        { q: "12. The teacher, along with the students, _____ coming.", opts: ["is", "are", "be"], a: "is", exp: "üë§ Chia theo 'The teacher', b·ªè qua c·ª•m 'along with...'." },
        { q: "13. One of my friends _____ a doctor.", opts: ["is", "are", "am"], a: "is", exp: "üë§ 'One' (M·ªôt ng∆∞·ªùi) trong s·ªë b·∫°n b√® -> S·ªë √≠t." },
        { q: "14. The list of names _____ very long.", opts: ["is", "are", "be"], a: "is", exp: "üìú Ch·ªß ng·ªØ l√† 'The list' (C√°i danh s√°ch) -> S·ªë √≠t." },
        { q: "15. My boss, as well as his assistants, _____ here.", opts: ["is", "are", "be"], a: "is", exp: "üë§ Chia theo 'My boss', b·ªè qua 'as well as...'." },

        // GROUP 4: SPECIAL NOUNS (Traffic, Glasses, Furniture)
        { q: "16. The traffic in Hanoi _____ crazy.", opts: ["is", "are", "be"], a: "is", exp: "üöó Traffic kh√¥ng ƒë·∫øm ƒë∆∞·ª£c -> S·ªë √≠t." },
        { q: "17. Where _____ my glasses?", opts: ["is", "are", "be"], a: "are", exp: "üëì Glasses (M·∫Øt k√≠nh) lu√¥n l√† s·ªë nhi·ªÅu." },
        { q: "18. Your new jeans _____ very fashionable.", opts: ["look", "looks", "looking"], a: "look", exp: "üëñ Jeans (Qu·∫ßn b√≤) lu√¥n l√† s·ªë nhi·ªÅu -> Look (nguy√™n th·ªÉ)." },
        { q: "19. The furniture in this room _____ old.", opts: ["is", "are", "be"], a: "is", exp: "ü™ë Furniture (N·ªôi th·∫•t) l√† danh t·ª´ kh√¥ng ƒë·∫øm ƒë∆∞·ª£c -> S·ªë √≠t." },
        { q: "20. Fish and chips _____ a popular dish in the UK.", opts: ["is", "are", "be"], a: "is", exp: "üçü Fish and chips l√† t√™n 1 m√≥n ƒÉn -> S·ªë √≠t." }
    ];

    const container = document.getElementById('quiz-container');
    let timerInterval;
    let totalTime = 15 * 60; // 15 ph√∫t
    let timeSpent = 0;

    // H√ÄM B·∫ÆT ƒê·∫¶U M·ªöI
    function startQuiz() {
        document.getElementById('start-screen').style.display = 'none'; // ·∫®n m√†n h√¨nh ch√†o
        document.getElementById('quiz-content').style.display = 'block'; // Hi·ªán b√†i thi
        document.getElementById('timer-bar').style.display = 'block'; // Hi·ªán ƒë·ªìng h·ªì
        
        initQuestions();
        startTimer(totalTime);
    }

    function initQuestions() {
        questions.forEach((item, index) => {
            let optionsHTML = '';
            item.opts.forEach(opt => {
                optionsHTML += `<label><input type="radio" name="q${index}" value="${opt}"> ${opt}</label>`;
            });

            container.innerHTML += `
                <div class="question-card" id="card-${index}">
                    <span class="question-text">${item.q}</span>
                    <div class="options">${optionsHTML}</div>
                    <div class="explanation-box" id="exp-${index}">
                        <span class="exp-title">üë®‚Äçüè´ Gi·∫£i th√≠ch:</span>
                        <span class="exp-content">${item.exp}</span>
                    </div>
                </div>
            `;
        });
    }

    function startTimer(duration) {
        let timer = duration, minutes, seconds;
        const display = document.getElementById('time');
        const timerBar = document.getElementById('timer-bar');

        timerInterval = setInterval(function () {
            timeSpent = duration - timer;
            minutes = parseInt(timer / 60, 10);
            seconds = parseInt(timer % 60, 10);

            minutes = minutes < 10 ? "0" + minutes : minutes;
            seconds = seconds < 10 ? "0" + seconds : seconds;

            display.textContent = minutes + ":" + seconds;

            if (timer < 60) timerBar.classList.add('warning');

            if (--timer < 0) {
                clearInterval(timerInterval);
                alert("H·∫øt gi·ªù! H·ªá th·ªëng s·∫Ω t·ª± n·ªôp b√†i.");
                submitQuiz();
            }
        }, 1000);
    }

    function formatTime(seconds) {
        let m = Math.floor(seconds / 60);
        let s = seconds % 60;
        return `${m} ph√∫t ${s} gi√¢y`;
    }

    function submitQuiz() {
        clearInterval(timerInterval);
        let score = 0;
        let reportText = `üìù K·∫æT QU·∫¢ B√ÄI "TR√ÅM L·ªñ H·ªîNG" (20 C√ÇU)\n`;
        reportText += `------------------------------\n`;
        reportText += `‚è∞ Th·ªùi gian l√†m: ${formatTime(timeSpent)}\n`;
        
        let wrongAnswers = [];

        questions.forEach((item, index) => {
            const selected = document.querySelector(`input[name="q${index}"]:checked`);
            const expBox = document.getElementById(`exp-${index}`);
            expBox.style.display = 'block';

            let userAnswer = selected ? selected.value : "Ch∆∞a ch·ªçn";
            let isCorrect = false;

            if (selected && selected.value === item.a) {
                score++;
                isCorrect = true;
                expBox.innerHTML = `<span class="correct-text">‚úÖ ƒê√∫ng r·ªìi!</span><br>` + expBox.innerHTML;
                document.getElementById(`card-${index}`).style.borderLeftColor = "#2a9d8f";
            } else {
                expBox.innerHTML = `<span class="wrong-text">‚ùå Sai r·ªìi. ƒê√°p √°n l√†: ${item.a}</span><br>` + expBox.innerHTML;
                document.getElementById(`card-${index}`).style.borderLeftColor = "#e63946";
                
                wrongAnswers.push({
                    idx: index + 1,
                    q: item.q,
                    user: userAnswer,
                    correct: item.a,
                    reason: item.exp
                });
            }
        });

        reportText += `üèÜ ƒêi·ªÉm s·ªë: ${score} / ${questions.length}\n\n`;
        
        if (score === questions.length) {
            reportText += `üåü QU√Å ƒê·ªàNH! V·ª£ ƒë√£ s·ª≠a h·∫øt s·∫°ch l·ªói sai r·ªìi!`;
        } else if (wrongAnswers.length > 0) {
            reportText += `‚ö†Ô∏è V·∫™N C√íN S√ìT M·∫§Y L·ªñI N√ÄY:\n`;
            wrongAnswers.forEach(w => {
                reportText += `‚ùå C√¢u ${w.idx}: ${w.q}\n`;
                reportText += `   - V·ª£ ch·ªçn: ${w.user}\n`;
                reportText += `   - ƒê√°p √°n ƒë√∫ng: ${w.correct}\n`;
                reportText += `   - Nh·ªõ n√®: ${w.reason}\n\n`;
            });
        }

        const reportArea = document.getElementById('report-section');
        const reportBox = document.getElementById('final-report');
        reportBox.value = reportText;
        reportArea.style.display = 'block';

        document.querySelector('.btn-submit').disabled = true;
        document.querySelector('.btn-submit').innerText = "ƒê√£ N·ªôp B√†i";
        document.getElementById('timer-bar').style.display = 'none';

        reportArea.scrollIntoView({behavior: "smooth"});
    }

    function copyReport() {
        const copyText = document.getElementById("final-report");
        copyText.select();
        copyText.setSelectionRange(0, 99999);
        navigator.clipboard.writeText(copyText.value).then(() => {
            const status = document.getElementById("copy-status");
            status.style.display = "inline";
            setTimeout(() => { status.style.display = "none"; }, 2000);
        });
    }

</script>
</body>
</html>